<div id="welcomeOverlay" class="welcome-overlay hidden">
    <div class="welcome-modal dark:bg-gray-800">
        <div class="text-5xl mb-4 animate-bounce-slow">
            <i class="fas fa-brain brain-logo"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-3">Welcome to Dimaagwale</h2>
        <p class="text-gray-600 dark:text-gray-300 mb-6">Let's test your knowledge and challenge your mind!</p>
        <div class="mb-4">
            <input type="text" id="welcomeName" placeholder="Enter your name" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
        </div>
        <button id="startJourney" class="gradient-bg text-white px-6 py-2 rounded-lg font-bold hover:opacity-90 transition-opacity">
                    Start Playing
                </button>
            </div>
        </div>

        <!-- Profile Modal -->
        <div id="profileModal" class="welcome-overlay hidden">
            <div class="welcome-modal dark:bg-gray-800">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Your Profile</h2>
                    <button onclick="closeProfileModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <p class="text-gray-600 dark:text-gray-300 mb-6">Save your progress and track your achievements!</p>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
                        <input type="text" id="profileName" placeholder="Your name" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                        <input type="email" id="profileEmail" placeholder="Your email" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Age (Optional)</label>
                        <input type="number" id="profileAge" placeholder="Your age" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    </div>
                </div>
                
                <div class="mt-6 flex justify-between">
                    <button onclick="closeProfileModal()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                        Skip for Now
                    </button>
                    <button id="saveProfile" class="gradient-bg text-white px-6 py-2 rounded-lg font-bold hover:opacity-90 transition-opacity">
                        Save Profile
                    </button>
                </div>
            </div>
        </div>

        <!-- Profile Sign-up Prompt (Enhanced) -->
        <div id="profilePrompt" class="fixed top-16 right-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg max-w-xs notification hidden profile-prompt pulse-animation">
            <div class="flex items-start">
                <div class="flex-shrink-0 text-purple-500">
                    <i class="fas fa-user-circle text-2xl"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-gray-800 dark:text-white">Save your progress?</h3>
                    <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Create a profile to track your achievements and compete on leaderboards!</p>
                    <div class="mt-2">
                        <button onclick="openProfileModal()" class="text-xs text-white bg-purple-500 px-3 py-1 rounded-full">Create Profile</button>
                    </div>
                </div>
                <button onclick="closeProfilePrompt()" class="ml-4 text-gray-400 hover:text-gray-500">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Notification Container -->
        <div id="notificationContainer" class="fixed top-4 right-4 z-50"></div>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-6">
            <!-- Home Screen -->
            <div id="homeScreen" class="screen">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4 animate-bounce-slow">
                        <i class="fas fa-brain brain-logo"></i>
                    </div>
                    <h2 class="text-4xl font-bold text-gray-800 dark:text-white mb-2">Welcome to Dimaagwale</h2>
                    <p class="text-xl text-gray-600 dark:text-gray-300">Challenge your mind, compete with friends!</p>
                </div>

                <!-- User Stats Dashboard -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 dark:text-gray-300">Current Rank</p>
                                <p class="text-2xl font-bold text-purple-600" id="userRank">Scholar</p>
                            </div>
                            <i class="fas fa-trophy text-3xl text-yellow-500"></i>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 dark:text-gray-300">Total XP</p>
                                <p class="text-2xl font-bold text-blue-600" id="userXP">2,450</p>
                            </div>
                            <i class="fas fa-star text-3xl text-blue-500"></i>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 dark:text-gray-300">Win Rate</p>
                                <p class="text-2xl font-bold text-green-600" id="winRate">78%</p>
                            </div>
                            <i class="fas fa-chart-line text-3xl text-green-500"></i>
                        </div>
                    </div>
                </div>

                <!-- Game Mode Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="quiz-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg cursor-pointer" onclick="showScreen('soloScreen')">
                        <div class="gradient-bg text-white rounded-lg p-4 mb-4">
                            <i class="fas fa-user text-3xl mb-2"></i>
                            <h3 class="text-xl font-bold">Solo Play</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Practice and learn with solo quizzes</p>
                        <div class="flex justify-between text-sm text-gray-500">
                            <span><i class="fas fa-clock"></i> 10 questions</span>
                            <span><i class="fas fa-heart"></i> 2 lifelines</span>
                        </div>
                    </div>

                    <div class="quiz-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg cursor-pointer" onclick="showScreen('battleScreen')">
                        <div class="gradient-orange text-white rounded-lg p-4 mb-4">
                            <i class="fas fa-users text-3xl mb-2"></i>
                            <h3 class="text-xl font-bold">Battle Mode</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Compete with players worldwide</p>
                        <div class="flex justify-between text-sm text-gray-500">
                            <span><i class="fas fa-trophy"></i> Live competition</span>
                            <span><i class="fas fa-bolt"></i> Speed matters</span>
                        </div>
                    </div>

                    <div class="quiz-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg cursor-pointer" onclick="showScreen('aspirantsScreen')">
                        <div class="gradient-green text-white rounded-lg p-4 mb-4">
                            <i class="fas fa-graduation-cap text-3xl mb-2"></i>
                            <h3 class="text-xl font-bold">Aspirants Corner</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Practice for competitive exams</p>
                        <div class="flex justify-between text-sm text-gray-500">
                            <span><i class="fas fa-book"></i> Exam prep</span>
                            <span><i class="fas fa-certificate"></i> UPSC, CAT, etc.</span>
                        </div>
                    </div>

                    <div class="quiz-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg cursor-pointer" onclick="showScreen('organizerScreen')">
                        <div class="gradient-purple text-white rounded-lg p-4 mb-4">
                            <i class="fas fa-crown text-3xl mb-2"></i>
                            <h3 class="text-xl font-bold">Host Quiz</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Create and host custom quizzes</p>
                        <div class="flex justify-between text-sm text-gray-500">
                            <span><i class="fas fa-edit"></i> Custom questions</span>
                            <span><i class="fas fa-share"></i> Share with friends</span>
                        </div>
                    </div>
                </div>

                <!-- Weekly Challenges -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg mb-6">
                    <h3 class="text-2xl font-bold text-gray-800 dark:text-white mb-4">
                        <i class="fas fa-calendar-week text-purple-500 mr-2"></i>
                        Weekly Challenge
                    </h3>
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">Science & Technology Quiz</p>
                            <p class="text-gray-600 dark:text-gray-400">Answer 50 questions correctly to win 500 coins!</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-gray-500">Progress: 32/50</p>
                            <div class="w-32 bg-gray-200 rounded-full h-2 mt-1">
                                <div class="bg-purple-600 h-2 rounded-full progress-bar" style="width: 64%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leaderboard Preview -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-2xl font-bold text-gray-800 dark:text-white">
                            <i class="fas fa-trophy text-yellow-500 mr-2"></i>
                            Top Players
                        </h3>
                        <button onclick="showScreen('leaderboardScreen')" class="text-purple-600 hover:text-purple-800">View All</button>
                    </div>
                    <div id="topPlayers" class="space-y-3">
                        <!-- Top players will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Solo Play Screen -->
            <div id="soloScreen" class="screen hidden">
                <div class="mb-6">
                    <button onclick="showScreen('homeScreen')" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Home
                    </button>
                </div>

                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-2">Solo Play Mode</h2>
                    <p class="text-gray-600 dark:text-gray-300">Choose a category and test your knowledge!</p>
                </div>

                <!-- Category Selection -->
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-8">
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="general">
                        <div class="text-center">
                            <i class="fas fa-globe text-3xl text-blue-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">General Knowledge</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="sports">
                        <div class="text-center">
                            <i class="fas fa-football-ball text-3xl text-green-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Sports</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="movies">
                        <div class="text-center">
                            <i class="fas fa-film text-3xl text-red-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Movies</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="history">
                        <div class="text-center">
                            <i class="fas fa-landmark text-3xl text-yellow-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">History</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="finance">
                        <div class="text-center">
                            <i class="fas fa-chart-pie text-3xl text-indigo-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Finance</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="aptitude">
                        <div class="text-center">
                            <i class="fas fa-brain text-3xl text-purple-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Aptitude</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="science">
                        <div class="text-center">
                            <i class="fas fa-atom text-3xl text-teal-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Science</h3>
                        </div>
                    </div>
                    <div class="category-card bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg cursor-pointer hover:shadow-xl transition-all" data-category="technology">
                        <div class="text-center">
                            <i class="fas fa-microchip text-3xl text-cyan-500 mb-2"></i>
                            <h3 class="font-bold text-gray-800 dark:text-white">Technology</h3>
                        </div>
                    </div>
                </div>

                <!-- Difficulty Selection -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg mb-6">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Select Difficulty</h3>
                    <div class="flex flex-wrap gap-4">
                        <button class="difficulty-btn bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors" data-difficulty="easy">
                            <i class="fas fa-seedling mr-2"></i>Easy
                            <p class="text-xs text-gray-100 mt-1">2 errors allowed</p>
                        </button>
                        <button class="difficulty-btn bg-yellow-500 text-white px-6 py-2 rounded-lg hover:bg-yellow-600 transition-colors" data-difficulty="medium">
                            <i class="fas fa-fire mr-2"></i>Medium
                            <p class="text-xs text-gray-100 mt-1">1 error allowed</p>
                        </button>
                        <button class="difficulty-btn bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors" data-difficulty="hard">
                            <i class="fas fa-skull mr-2"></i>Hard
                            <p class="text-xs text-gray-100 mt-1">No errors allowed</p>
                        </button>
                    </div>
                </div>

                <div class="text-center">
                    <button id="startSoloGame" class="gradient-bg text-white px-8 py-3 rounded-lg text-xl font-bold hover:opacity-90 transition-opacity disabled:opacity-50" disabled>
                        <i class="fas fa-play mr-2"></i>Start Game
                    </button>
                </div>
            </div>

            <!-- Solo Game Screen -->
            <div id="soloGameScreen" class="screen hidden">
                <!-- Game content will be loaded dynamically -->
            </div>

            <!-- Battle Mode Screen -->
            <div id="battleScreen" class="screen hidden">
                <!-- Battle mode content will be loaded dynamically -->
            </div>

            <!-- Aspirants Corner Screen -->
            <div id="aspirantsScreen" class="screen hidden">
                <!-- Aspirants content will be loaded dynamically -->
            </div>

            <!-- Leaderboard Screen -->
            <div id="leaderboardScreen" class="screen hidden">
                <!-- Leaderboard content will be loaded dynamically -->
            </div>
            
            <!-- Organizer Screen -->
            <div id="organizerScreen" class="screen hidden">
                <!-- Organizer content will be loaded dynamically -->
            </div>
        </main>
    </div>

    <script>
        // Global variables
        let currentScreen = 'homeScreen';
        let selectedCategory = null;
        let selectedDifficulty = null;
        let gameQuestions = [];
        let currentQuestion = 0;
        let score = 0;
        let answeredCorrectly = 0;
        let totalAnswered = 0;
        let errorsLeft = 2;
        let lifelinesUsed = {
            '50-50': false,
            'skip': false
        };
        let darkMode = false;
        
        // User object - with minimal required info by default
        let user = {
            name: 'Player',
            email: '',
            age: null,
            coins: 1000,
            xp: 2450,
            rank: 'Scholar',
            winRate: '78%',
            signedUp: false,
            settings: {theme: 'light'}
        };
        
        // Sample top players data
        const topPlayersData = [
            { name: "QuizMaster", xp: 12450, rank: "Genius", avatar: "ðŸ‘‘" },
            { name: "BrainWave", xp: 10280, rank: "Expert", avatar: "ðŸ§ " },
            { name: "QuizWiz", xp: 9870, rank: "Scholar", avatar: "ðŸ”®" },
            { name: "KnowItAll", xp: 8240, rank: "Master", avatar: "ðŸŒŸ" }
        ];
        
        // Sample question data
        const questionsData = {
            general: {
                easy: [
                    {
                        question: "What is the capital of France?",
                        options: ["London", "Berlin", "Paris", "Madrid"],
                        correct: 2
                    },
                    {
                        question: "Which planet is known as the Red Planet?",
                        options: ["Venus", "Mars", "Jupiter", "Saturn"],
                        correct: 1
                    },
                    {
                        question: "Who painted the Mona Lisa?",
                        options: ["Pablo Picasso", "Vincent van Gogh", "Leonardo da Vinci", "Michelangelo"],
                        correct: 2
                    }
                    // More questions would be added here
                ],
                medium: [
                    {
                        question: "What year did World War II end?",
                        options: ["1943", "1944", "1945", "1946"],
                        correct: 2
                    }
                    // More questions would be added here
                ],
                hard: [
                    {
                        question: "What is the chemical symbol for gold?",
                        options: ["Go", "Gd", "Au", "Ag"],
                        correct: 2
                    }
                    // More questions would be added here
                ]
            },
            // More categories would be defined here
            sports: { easy: [], medium: [], hard: [] },
            movies: { easy: [], medium: [], hard: [] },
            history: { easy: [], medium: [], hard: [] },
            finance: { easy: [], medium: [], hard: [] },
            aptitude: { easy: [], medium: [], hard: [] },
            science: { easy: [], medium: [], hard: [] },
            technology: { easy: [], medium: [], hard: [] }
        };
        
        // Initialize the app
        function initializeApp() {
            // Load user data if it exists
            if (localStorage.getItem('dimaagwaleUser')) {
                user = JSON.parse(localStorage.getItem('dimaagwaleUser'));
                updateUserDisplay();
                showScreen('homeScreen');
                // Only show profile prompt if the user hasn't signed up
                if (!user.signedUp) {
                    setTimeout(showProfilePrompt, 3000);
                }
            } else {
                // Show welcome screen for first-time visitors
                document.getElementById('welcomeOverlay').classList.remove('hidden');
            }
            
            // Setup theme based on user preference or system preference
            if (user.settings && user.settings.theme === 'dark') {
                document.body.classList.add('dark');
                darkMode = true;
                document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // Populate top players
            populateTopPlayers();
            
            // Setup event listeners
            setupEventListeners();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // User profile button
            document.getElementById('userProfile').addEventListener('click', openProfileModal);
            
            // Welcome modal "Start Journey" button
            document.getElementById('startJourney').addEventListener('click', startJourney);
            
            // Profile modal "Save Profile" button
            document.getElementById('saveProfile').addEventListener('click', saveUserProfile);
            
            // Category cards in Solo mode
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.category-card').forEach(c => c.classList.remove('ring-2', 'ring-purple-500'));
                    card.classList.add('ring-2', 'ring-purple-500');
                    selectedCategory = card.dataset.category;
                    updateStartButton();
                });
            });
            
            // Difficulty buttons in Solo mode
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('ring-2', 'ring-white'));
                    btn.classList.add('ring-2', 'ring-white');
                    selectedDifficulty = btn.dataset.difficulty;
                    updateStartButton();
                });
            });
            
            // Start Solo Game button
            document.getElementById('startSoloGame').addEventListener('click', startSoloGame);
        }
        
        // Start the journey with just a name
        function startJourney() {
            const nameInput = document.getElementById('welcomeName');
            const name = nameInput.value.trim();
            
            if (name.length < 2) {
                showNotification("Please enter a valid name", "error");
                nameInput.focus();
                return;
            }
            
            // Set the name in user object 
            user.name = name;
            saveUserData();
            updateUserDisplay();
            
            // Hide welcome overlay and show home screen
            document.getElementById('welcomeOverlay').classList.add('hidden');
            showScreen('homeScreen');
            
            // Show a welcome message with the user's name
            showNotification(`Welcome, ${name}! Enjoy the game!`, "success");
            
            // Show profile prompt after a delay
            setTimeout(showProfilePrompt, 5000);
        }
        
        // Show the profile prompt to encourage users to create a full profile
        function showProfilePrompt() {
            if (!user.signedUp) {
                document.getElementById('profilePrompt').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('profilePrompt').classList.add('hidden');
                }, 10000);
            }
        }
        
        // Close the profile prompt
        function closeProfilePrompt() {
            document.getElementById('profilePrompt').classList.add('hidden');
        }
        
        // Open the profile modal
        function openProfileModal() {
            // Pre-fill modal with existing user data
            document.getElementById('profileName').value = user.name;
            if (user.email) document.getElementById('profileEmail').value = user.email;
            if (user.age) document.getElementById('profileAge').value = user.age;
            
            document.getElementById('profileModal').classList.remove('hidden');
        }
        
        // Close the profile modal
        function closeProfileModal() {
            document.getElementById('profileModal').classList.add('hidden');
        }
        
        // Save user profile
        function saveUserProfile() {
            const name = document.getElementById('profileName').value.trim();
            const email = document.getElementById('profileEmail').value.trim();
            const age = document.getElementById('profileAge').value.trim();
            
            if (name.length < 2) {
                showNotification("Please enter a valid name", "error");
                return;
            }
            
            if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
                showNotification("Please enter a valid email address", "error");
                return;
            }
            
            user.name = name;
            user.email = email;
            user.age = age ? parseInt(age) : null;
            user.signedUp = true;
            
            saveUserData();
            updateUserDisplay();
            
            closeProfileModal();
            showNotification("Profile saved successfully!", "success");
        }
        
        // Save user data to local storage
        function saveUserData() {
            localStorage.setItem('dimaagwaleUser', JSON.stringify(user));
        }
        
        // Update the displayed user information
        function updateUserDisplay() {
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userCoins').textContent = user.coins;
            document.getElementById('userRank').textContent = user.rank;
            document.getElementById('userXP').textContent = user.xp;
            document.getElementById('winRate').textContent = user.winRate;
        }
        
        // Show notification
        function showNotification(message, type = "info") {
            const notification = document.createElement('div');
            notification.className = `bg-white dark:bg-gray-800 shadow-lg rounded-lg p-4 mb-4 notification ${type === 'error' ? 'border-l-4 border-red-500' : type === 'success' ? 'border-l-4 border-green-500' : 'border-l-4 border-blue-500'}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas ${type === 'error' ? 'fa-exclamation-circle text-red-500' : type === 'success' ? 'fa-check-circle text-green-500' : 'fa-info-circle text-blue-500'}"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-gray-800 dark:text-white">${message}</p>
                    </div>
                </div>
            `;
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('opacity-0', 'translate-y-[-20px]');
                notification.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                setTimeout(() => {
                    notification.remove();
                }, 500);
            }, 3000);
        }
        
        // Show a specific screen
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
            currentScreen = screenId;
            
            // Show/hide the fixed home button based on current screen
            if (screenId === 'homeScreen') {
                document.getElementById('fixedHomeButton').classList.add('hidden');
            } else {
                document.getElementById('fixedHomeButton').classList.remove('hidden');
            }
        }
        
        // Toggle between light/dark theme
        function toggleTheme() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark');
            document.getElementById('themeToggle').innerHTML = darkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            user.settings.theme = darkMode ? 'dark' : 'light';
            saveUserData();
        }
        
        // Populate top players
        function populateTopPlayers() {
            const playersContainer = document.getElementById('topPlayers');
            playersContainer.innerHTML = '';
            
            topPlayersData.forEach((player, index) => {
                const playerElement = document.createElement('div');
                playerElement.className = 'leaderboard-item bg-gray-100 dark:bg-gray-700 rounded-lg p-3 flex items-center justify-between';
                playerElement.style.animationDelay = `${index * 0.1}s`;
                
                playerElement.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full gradient-bg flex items-center justify-center text-lg font-bold mr-3">
                            ${player.avatar}
                        </div>
                        <div>
                            <p class="font-medium text-gray-800 dark:text-white">${player.name}</p>
                            <p class="text-xs text-gray-500">${player.rank}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-purple-600">${player.xp} XP</p>
                        <p class="text-xs text-gray-500">${index + 1 === 1 ? '1st' : index + 1 === 2 ? '2nd' : index + 1 === 3 ? '3rd' : `${index + 1}th`}</p>
                    </div>
                `;
                
                playersContainer.appendChild(playerElement);
            });
        }
        
        // Update the start button state based on selections
        function updateStartButton() {
            const startButton = document.getElementById('startSoloGame');
            if (selectedCategory && selectedDifficulty) {
                startButton.disabled = false;
                startButton.classList.remove('opacity-50');
            } else {
                startButton.disabled = true;
                startButton.classList.add('opacity-50');
            }
        }
        
        // Start a solo game
        function startSoloGame() {
            if (!selectedCategory || !selectedDifficulty) {
                showNotification("Please select a category and difficulty level", "warning");
                return;
            }
            
            // Redirect to game screen (in a real implementation, this would load questions, etc.)
            showScreen('soloGameScreen');
            
            // Display a loading message for demo purposes
            document.getElementById('soloGameScreen').innerHTML = `
                <div class="flex items-center justify-center h-64">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500 mb-4"></div>
                        <p class="text-gray-700 dark:text-gray-300">Loading ${selectedCategory} questions...</p>
                    </div>
                </div>
            `;
            
            // Simulate loading for demo
            setTimeout(() => {
                showNotification("Game feature is under development", "info");
                showScreen('soloScreen');
            }, 2000);
        }
        
        // Helper function to get random questions from an array
        function getRandomQuestions(questions, count) {
            const shuffled = [...questions].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }
        
        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
