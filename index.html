<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dimaagwale - Quiz & Battle Platform</title>
  <!-- Tailwind CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <!-- FontAwesome CDN for icons -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <style>
    .blur-bg {
      backdrop-filter: blur(8px);
      background: rgba(0, 0, 0, 0.4);
    }
    .modal {
      z-index: 50;
    }
    .fixed-home {
      z-index: 60;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen font-sans">
  <!-- Always-visible Back to Home Button -->
  <button
    id="homeBtn"
    onclick="showScreen('homeScreen')"
    class="fixed-home hidden top-4 left-4 bg-blue-700 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-blue-800 transition"
    title="Back to Home"
  >
    <i class="fas fa-home mr-2"></i>Home
  </button>

  <!-- Welcome Modal -->
  <div id="welcomeModal" class="modal fixed inset-0 flex items-center justify-center blur-bg">
    <div class="bg-white rounded-xl shadow-lg p-8 text-center max-w-sm mx-auto">
      <h2 class="text-2xl font-bold mb-2">Welcome to Dimaagwale!</h2>
      <p class="mb-4">Enter your name to start your knowledge journey.</p>
      <input
        id="userNameInput"
        class="border rounded px-3 py-2 w-full mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
        type="text"
        placeholder="Your Name"
        required
        autofocus
      />
      <button
        onclick="startSession()"
        class="bg-blue-500 text-white px-6 py-2 rounded-lg w-full hover:bg-blue-600 transition"
      >
        Letâ€™s Begin!
      </button>
    </div>
  </div>

  <!-- Save Profile Modal -->
  <div
    id="saveProfileModal"
    class="modal fixed inset-0 flex items-center justify-center blur-bg hidden"
    onclick="if(event.target === this) this.classList.add('hidden')"
  >
    <form onsubmit="return saveProfile()" class="bg-white rounded-xl shadow-lg p-8 text-left space-y-4 max-w-sm mx-auto">
      <h3 class="font-bold text-xl mb-2">Save Your Progress</h3>
      <input
        id="profileName"
        type="text"
        required
        placeholder="Name"
        class="w-full border px-3 py-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500"
      />
      <input
        id="profileEmail"
        type="email"
        required
        placeholder="Email"
        class="w-full border px-3 py-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500"
      />
      <input
        id="profileAge"
        type="number"
        min="1"
        placeholder="Age (optional)"
        class="w-full border px-3 py-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500"
      />
      <button type="submit" class="bg-green-500 text-white px-6 py-2 rounded-lg w-full hover:bg-green-600 transition">
        Save Profile
      </button>
    </form>
  </div>

  <!-- Main Screens -->
  <div id="homeScreen" class="max-w-3xl mx-auto py-10 px-4">
    <h1 class="text-4xl font-bold text-center mb-4 text-blue-800">Dimaagwale</h1>
    <h2 class="text-xl text-center mb-8">Test your knowledge, challenge friends, and prepare for top exams!</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div
        class="quiz-card bg-white p-6 rounded-xl shadow hover:bg-blue-50 cursor-pointer transition"
        onclick="showScreen('soloScreen')"
        title="Play solo quizzes"
      >
        <h3 class="text-2xl font-semibold mb-2">Solo Play</h3>
        <p>Choose a category & difficulty. Use lifelines. Beat your own high score!</p>
      </div>
      <div
        class="quiz-card bg-white p-6 rounded-xl shadow hover:bg-blue-50 cursor-pointer transition"
        onclick="showScreen('battleScreen')"
        title="Compete with others"
      >
        <h3 class="text-2xl font-semibold mb-2">Battle Mode</h3>
        <p>Compete live with friends or random players in quiz battles.</p>
      </div>
      <div
        class="quiz-card bg-white p-6 rounded-xl shadow hover:bg-blue-50 cursor-pointer transition"
        onclick="showScreen('aspirantsScreen')"
        title="Practice for competitive exams"
      >
        <h3 class="text-2xl font-semibold mb-2">Aspirants Corner</h3>
        <p>Practice for UPSC, CAT, SSC, IBPS, Railways, GMAT and more. Level up your prep!</p>
      </div>
      <div
        class="quiz-card bg-white p-6 rounded-xl shadow hover:bg-blue-50 cursor-pointer transition"
        onclick="showScreen('profileScreen')"
        title="Manage your profile"
      >
        <h3 class="text-2xl font-semibold mb-2">Player Profile</h3>
        <p>View your stats, save progress, and manage your info.</p>
      </div>
    </div>
  </div>

  <!-- Solo Play Screen -->
  <div id="soloScreen" class="hidden max-w-3xl mx-auto py-10 px-4">
    <h2 class="text-2xl font-bold mb-4 text-blue-800">Solo Play</h2>
    <div class="mb-4">
      <label class="block mb-1 font-semibold" for="soloCategory">Choose Category:</label>
      <select
        id="soloCategory"
        class="border px-3 py-2 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="finance">Finance</option>
        <option value="aptitude">Aptitude</option>
        <option value="statistics">Statistics</option>
        <option value="maths">Mathematics</option>
        <option value="science">Science</option>
        <option value="technology">Technology</option>
        <option value="current">Current Affairs</option>
        <option value="literature">Literature</option>
      </select>
      <label class="block mb-1 font-semibold" for="soloDifficulty">Difficulty:</label>
      <select
        id="soloDifficulty"
        class="border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
    <button onclick="startSoloQuiz()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
      Start Quiz
    </button>
    <div id="soloQuizBox" class="mt-6 hidden"></div>
  </div>

  <!-- Battle Mode Screen -->
  <div id="battleScreen" class="hidden max-w-3xl mx-auto py-10 px-4">
    <h2 class="text-2xl font-bold mb-4 text-blue-800">Battle Mode</h2>
    <p class="mb-4">
      Create a quiz or join a quiz battle.<br />
      <span class="text-sm text-gray-700">To create a quiz, you must be registered.</span>
    </p>
    <div class="flex flex-col md:flex-row gap-4 mb-6">
      <button
        onclick="showBattleCreate()"
        class="bg-green-600 text-white px-6 py-2 rounded-lg flex-1 hover:bg-green-700 transition"
      >
        Create Quiz Battle
      </button>
      <button
        onclick="showBattleJoin()"
        class="bg-yellow-600 text-white px-6 py-2 rounded-lg flex-1 hover:bg-yellow-700 transition"
      >
        Join Quiz Battle
      </button>
    </div>
    <div id="battleCreateBox" class="hidden">
      <h3 class="font-semibold mb-2">Create Battle Quiz</h3>
      <label for="battleCategory">Category:</label>
      <select
        id="battleCategory"
        class="border px-2 py-1 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-green-500"
      >
        <option value="finance">Finance</option>
        <option value="aptitude">Aptitude</option>
        <option value="statistics">Statistics</option>
        <option value="maths">Mathematics</option>
        <option value="science">Science</option>
        <option value="technology">Technology</option>
        <option value="current">Current Affairs</option>
        <option value="literature">Literature</option>
      </select>
      <label for="battleDifficulty">Difficulty:</label>
      <select
        id="battleDifficulty"
        class="border px-2 py-1 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-green-500"
      >
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
      <label for="battlePlayers">Players:</label>
      <select
        id="battlePlayers"
        class="border px-2 py-1 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-green-500"
      >
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="open">Open for All</option>
      </select>
      <button
        class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
        onclick="alert('Lobby created! (Demo only)')"
      >
        Create Lobby
      </button>
    </div>
    <div id="battleJoinBox" class="hidden">
      <h3 class="font-semibold mb-2">Join a Quiz Battle</h3>
      <p>Enter lobby code or join an open quiz (Demo only).</p>
      <input
        class="border px-2 py-1 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-yellow-500"
        placeholder="Lobby Code"
      />
      <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Join</button>
    </div>
  </div>

  <!-- Aspirants Corner -->
  <div id="aspirantsScreen" class="hidden max-w-3xl mx-auto py-10 px-4">
    <h2 class="text-2xl font-bold mb-4 text-blue-800">Aspirants Corner</h2>
    <p class="mb-4">Select your exam and level to start practicing!</p>
    <div class="mb-4">
      <label class="block mb-1 font-semibold" for="aspirantExam">Exam:</label>
      <select
        id="aspirantExam"
        class="border px-3 py-2 rounded w-full mb-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="upsc">UPSC</option>
        <option value="cat">CAT</option>
        <option value="ibps">IBPS</option>
        <option value="cgl">CGL</option>
        <option value="ssc">SSC</option>
        <option value="railway">Railways</option>
        <option value="gmat">GMAT</option>
      </select>
      <label class="block mb-1 font-semibold" for="aspirantLevel">Level:</label>
      <select
        id="aspirantLevel"
        class="border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="prelims">Prelims</option>
        <option value="master">Master</option>
      </select>
    </div>
    <button onclick="startAspirantQuiz()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
      Start Practice
    </button>
    <div id="aspirantQuizBox" class="mt-6 hidden"></div>
  </div>

  <!-- Player Profile -->
  <div id="profileScreen" class="hidden max-w-3xl mx-auto py-10 px-4">
    <h2 class="text-2xl font-bold mb-4 text-blue-800">Player Profile</h2>
    <div id="profileInfo" class="mb-4"></div>
    <button onclick="showSaveProfileModal()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">
      Save/Update Profile
    </button>
    <div class="mt-6">
      <h3 class="font-semibold mb-2">Your Scores</h3>
      <div id="scoreTable" class="overflow-x-auto"></div>
    </div>
  </div>

  <script>
    // Utility Functions
    function showScreen(screen) {
      // Hide all screens
      document.querySelectorAll('div[id$="Screen"]').forEach((d) => d.classList.add('hidden'));
      // Show requested screen
      document.getElementById(screen).classList.remove('hidden');
      // Show/hide home button
      document.getElementById('homeBtn').classList.toggle('hidden', screen === 'homeScreen');
      // Hide quiz boxes
      if (screen === 'soloScreen') document.getElementById('soloQuizBox').classList.add('hidden');
      if (screen === 'aspirantsScreen') document.getElementById('aspirantQuizBox').classList.add('hidden');
      if (screen === 'battleScreen') {
        document.getElementById('battleCreateBox').classList.add('hidden');
        document.getElementById('battleJoinBox').classList.add('hidden');
      }
      if (screen === 'profileScreen') showProfile();
    }

    // Welcome Modal Logic
    function startSession() {
      const name = document.getElementById('userNameInput').value.trim();
      if (!name) return alert('Please enter your name!');
      localStorage.setItem('dimaagwaleUser', JSON.stringify({ name }));
      document.getElementById('welcomeModal').style.display = 'none';
      showScreen('homeScreen');
    }

    // Save Profile Modal
    function showSaveProfileModal() {
      const user = JSON.parse(localStorage.getItem('dimaagwaleUser')) || {};
      document.getElementById('profileName').value = user.name || '';
      document.getElementById('profileEmail').value = user.email || '';
      document.getElementById('profileAge').value = user.age || '';
      document.getElementById('saveProfileModal').classList.remove('hidden');
    }
    function saveProfile() {
      const name = document.getElementById('profileName').value.trim();
      const email = document.getElementById('profileEmail').value.trim();
      const age = document.getElementById('profileAge').value.trim();
      if (!name || !email) {
        alert('Name and Email are required.');
        return false;
      }
      localStorage.setItem('dimaagwaleUser', JSON.stringify({ name, email, age }));
      document.getElementById('saveProfileModal').classList.add('hidden');
      showProfile();
      alert('Profile saved successfully!');
      return false;
    }

    // Profile Info
    function showProfile() {
      const user = JSON.parse(localStorage.getItem('dimaagwaleUser')) || {};
      let html = `<div class="mb-2"><b>Name:</b> ${user.name || '-'}</div>
                  <div class="mb-2"><b>Email:</b> ${user.email || '-'}</div>
                  <div class="mb-2"><b>Age:</b> ${user.age || '-'}</div>`;
      document.getElementById('profileInfo').innerHTML = html;
      // Scores
      let scores = JSON.parse(localStorage.getItem('dimaagwaleScores') || '{}');
      if (Object.keys(scores).length === 0) {
        document.getElementById('scoreTable').innerHTML = '<p>No scores yet.</p>';
        return;
      }
      let scoreHtml =
        '<table class="w-full border border-collapse text-left"><thead><tr><th class="border px-2 py-1">Mode</th><th class="border px-2 py-1">Category/Exam</th><th class="border px-2 py-1">Level</th><th class="border px-2 py-1">Score</th></tr></thead><tbody>';
      for (let k in scores) {
        let [mode, cat, lvl] = k.split('|');
        scoreHtml += `<tr>
          <td class="border px-2 py-1">${mode}</td>
          <td class="border px-2 py-1">${cat}</td>
          <td class="border px-2 py-1">${lvl}</td>
          <td class="border px-2 py-1">${scores[k]}</td>
        </tr>`;
      }
      scoreHtml += '</tbody></table>';
      document.getElementById('scoreTable').innerHTML = scoreHtml;
    }

    // Solo Quiz Data (Sample)
    const soloQuestions = {
      finance: {
        easy: [
          {
            q: "What is the full form of 'IPO'?",
            a: "Initial Public Offering",
            opts: [
              "Initial Public Offering",
              "Indian Payment Option",
              "International Purchase Order",
              "Investment Plan Option",
            ],
          },
          {
            q: "Which is a type of mutual fund?",
            a: "Equity Fund",
            opts: ["Equity Fund", "Savings Account", "Fixed Deposit", "Recurring Deposit"],
          },
        ],
        medium: [
          {
            q: "What is 'inflation'?",
            a: "General increase in prices",
            opts: [
              "General increase in prices",
              "Decrease in money supply",
              "Increase in exports",
              "Decrease in taxes",
            ],
          },
        ],
        hard: [
          {
            q: "What is 'quantitative easing'?",
            a: "Central bank injects money",
            opts: [
              "Central bank injects money",
              "Government increases taxes",
              "Stock market regulation",
              "Currency devaluation",
            ],
          },
        ],
      },
      maths: {
        easy: [
          { q: "What is 15 + 6?", a: "21", opts: ["21", "19", "20", "22"] },
          { q: "Square root of 64?", a: "8", opts: ["6", "7", "8", "9"] },
        ],
        medium: [{ q: "What is 12 x 12?", a: "144", opts: ["124", "144", "132", "142"] }],
        hard: [{ q: "Integral of x dx?", a: "x^2/2 + C", opts: ["x^2/2 + C", "2x + C", "ln(x) + C", "x^2 + C"] }],
      },
      // Add more categories/questions as needed
    };

    // Start Solo Quiz
    function startSoloQuiz() {
      const cat = document.getElementById('soloCategory').value;
      const lvl = document.getElementById('soloDifficulty').value;
      let questions = (soloQuestions[cat] && soloQuestions[cat][lvl]) || [];
      if (questions.length < 1) return alert("No questions in this category/level yet.");
      questions = shuffle([...questions]); // Randomize order
      showSoloQuiz(questions, cat, lvl);
    }

    // Show Solo Quiz UI and Logic
    function showSoloQuiz(questions, cat, lvl) {
      let idx = 0,
        score = 0,
        wrong = 0;
      let lifelines = { fifty: true, skip: true };
      let maxWrong = lvl === 'easy' ? 2 : lvl === 'medium' ? 1 : 0;

      function render() {
        if (idx >= 10 || idx >= questions.length) {
          saveScore('Solo', cat, lvl, score);
          document.getElementById('soloQuizBox').innerHTML = `<div class="text-xl font-bold mb-4">Quiz Finished!<br>Your Score: ${score}/10</div>
            <button onclick="showScreen('homeScreen')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Back to Home</button>`;
          return;
        }
        let q = questions[idx];
        let opts = shuffle([...q.opts]);
        let html = `<div class="mb-2 font-semibold">Q${idx + 1}: ${q.q}</div>
          <div class="space-y-2 mb-4">`;
        opts.forEach((opt) => {
          html += `<button class="block w-full text-left border px-4 py-2 rounded hover:bg-blue-100 transition"
            onclick="window._answer('${opt.replace(/'/g, "\\'")}')">${opt}</button>`;
        });
        html += `</div>
          <div class="mb-2">Lifelines: 
            <button ${!lifelines.fifty ? 'disabled' : ''} class="mx-1 px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 transition" onclick="window._fiftyFifty()">50/50</button>
            <button ${!lifelines.skip ? 'disabled' : ''} class="mx-1 px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 transition" onclick="window._skip()">Skip</button>
          </div>
          <div>Wrong Answers: ${wrong} / ${maxWrong}</div>`;
        document.getElementById('soloQuizBox').innerHTML = html;
        document.getElementById('soloQuizBox').classList.remove('hidden');

        // Bind answer function
        window._answer = function (opt) {
          if (opt === q.a) {
            score++;
            idx++;
            render();
          } else {
            wrong++;
            if (wrong > maxWrong) {
              document.getElementById('soloQuizBox').innerHTML = `<div class="text-xl font-bold mb-4">Game Over!<br>Your Score: ${score}/10</div>
                <button onclick="startSoloQuiz()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Try Again</button>
                <button onclick="showScreen('homeScreen')" class="bg-gray-600 text-white px-4 py-2 rounded ml-2 hover:bg-gray-700 transition">Home</button>`;
              return;
            }
            idx++;
            render();
          }
        };

        // Lifelines
        window._fiftyFifty = function () {
          if (!lifelines.fifty) return;
          lifelines.fifty = false;
          let wrongOpts = opts.filter((o) => o !== q.a);
          let toRemove = shuffle(wrongOpts).slice(0, 2);
          opts = opts.filter((o) => !toRemove.includes(o));
          let btns = document.querySelectorAll('#soloQuizBox button');
          btns.forEach((btn) => {
            if (toRemove.includes(btn.textContent)) btn.disabled = true;
          });
        };
        window._skip = function () {
          if (!lifelines.skip) return;
          lifelines.skip = false;
          idx++;
          render();
        };
      }
      render();
    }

    // Aspirants Corner Data (Sample)
    const aspirantQuestions = {
      upsc: {
        prelims: [
          {
            q: "Who is the current President of India?",
            a: "Draupadi Murmu",
            opts: ["Draupadi Murmu", "Ram Nath Kovind", "Narendra Modi", "Amit Shah"],
          },
        ],
        master: [
          {
            q: "Which article of Indian Constitution deals with Emergency?",
            a: "Article 352",
            opts: ["Article 352", "Article 370", "Article 356", "Article 360"],
          },
        ],
      },
      // Add more exams/questions here
    };

    // Start Aspirants Quiz
    function startAspirantQuiz() {
      const exam = document.getElementById('aspirantExam').value;
      const lvl = document.getElementById('aspirantLevel').value;
      let questions = (aspirantQuestions[exam] && aspirantQuestions[exam][lvl]) || [];
      if (questions.length < 1) return alert("No questions in this exam/level yet.");
      questions = shuffle([...questions]);
      showAspirantQuiz(questions, exam, lvl);
    }

    // Show Aspirants Quiz UI and Logic
    function showAspirantQuiz(questions, exam, lvl) {
      let idx = 0,
        score = 0;
      function render() {
        if (idx >= 10 || idx >= questions.length) {
          saveScore('Aspirant', exam, lvl, score);
          document.getElementById('aspirantQuizBox').innerHTML = `<div class="text-xl font-bold mb-4">Practice Complete!<br>Your Score: ${score}/10</div>
            <button onclick="showScreen('homeScreen')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Back to Home</button>`;
          return;
        }
        let q = questions[idx];
        let opts = shuffle([...q.opts]);
        let html = `<div class="mb-2 font-semibold">Q${idx + 1}: ${q.q}</div>
          <div class="space-y-2 mb-4">`;
        opts.forEach((opt) => {
          html += `<button class="block w-full text-left border px-4 py-2 rounded hover:bg-blue-100 transition"
            onclick="window._aspAnswer('${opt.replace(/'/g, "\\'")}')">${opt}</button>`;
        });
        html += `</div>`;
        document.getElementById('aspirantQuizBox').innerHTML = html;
        document.getElementById('aspirantQuizBox').classList.remove('hidden');
        window._aspAnswer = function (opt) {
          if (opt === q.a) score++;
          idx++;
          render();
        };
      }
      render();
    }

    // Battle Mode UI Demo
    function showBattleCreate() {
      document.getElementById('battleCreateBox').classList.remove('hidden');
      document.getElementById('battleJoinBox').classList.add('hidden');
    }
    function showBattleJoin() {
      document.getElementById('battleJoinBox').classList.remove('hidden');
      document.getElementById('battleCreateBox').classList.add('hidden');
    }

    // Score Saving
    function saveScore(mode, cat, lvl, score) {
      let scores = JSON.parse(localStorage.getItem('dimaagwaleScores') || '{}');
      let key = `${mode}|${cat}|${lvl}`;
      if (!scores[key] || score > scores[key]) scores[key] = score;
      localStorage.setItem('dimaagwaleScores', JSON.stringify(scores));
    }

    // Shuffle helper
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // On load
    window.onload = function () {
      if (!localStorage.getItem('dimaagwaleUser')) {
        document.getElementById('welcomeModal').style.display = 'flex';
      } else {
        document.getElementById('welcomeModal').style.display = 'none';
        showScreen('homeScreen');
      }
    };
  </script>
</body>
</html>
